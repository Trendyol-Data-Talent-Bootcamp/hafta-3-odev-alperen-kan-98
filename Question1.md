```
SELECT
  NAME,
  CAR_UN.ID AS CAR_ID,
  CAR_UN.MODEL AS CAR_MODEL,
  MANUFACTURE_UN.YEAR AS MANUFACTURE_YEAR,
  ARRAY(SELECT AS STRUCT PURCHASE_UN.ID,
                         (TIMESTAMP_ADD(PURCHASE_UN.DATE, INTERVAL 3 HOUR)) AS DATE
        FROM UNNEST(PURCHASE) AS PURCHASE_UN) AS PURCHASE
FROM alperen_kan.semi_structured_hw
CROSS JOIN UNNEST(CAR) AS CAR_UN
CROSS JOIN UNNEST(MANUFACTURE) AS MANUFACTURE_UN
ON CAR_UN.ID = MANUFACTURE_UN.ID
ORDER BY NAME

```
